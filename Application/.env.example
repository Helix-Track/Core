# HelixTrack Core - Environment Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database type: sqlite or postgresql
DB_TYPE=sqlite

# SQLite Configuration
DB_PATH=/app/Database/helixtrack.db

# PostgreSQL Configuration
DB_HOST=postgres
DB_PORT=5432
DB_NAME=helixtrack
DB_USER=helixtrack
DB_PASSWORD=helixtrack_secure_password_change_me
DB_SSLMODE=disable
# DB_SSLMODE options: disable, require, verify-ca, verify-full

# Database connection pool (PostgreSQL only)
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Server host and port
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# TLS/HTTPS Configuration
TLS_ENABLED=false
TLS_CERT_FILE=/app/certs/server.crt
TLS_KEY_FILE=/app/certs/server.key
TLS_MIN_VERSION=1.2

# Server timeouts
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s
SERVER_SHUTDOWN_TIMEOUT=30s

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Log output: stdout, file, or both
LOG_OUTPUT=both

# Log file configuration
LOG_PATH=/app/logs
LOG_FILENAME=helixtrack.log
LOG_MAX_SIZE=100
LOG_MAX_BACKUPS=3
LOG_MAX_AGE=28
LOG_COMPRESS=true

# Structured logging format: json or console
LOG_FORMAT=json

# =============================================================================
# SERVICE DISCOVERY CONFIGURATION
# =============================================================================

# Health check settings
HEALTH_CHECK_INTERVAL=60s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_FAILURE_THRESHOLD=3

# Failover settings
FAILOVER_ENABLED=true
FAILOVER_STABILITY_COUNT=3
FAILBACK_DELAY=5m

# Service rotation security
ADMIN_TOKEN_MIN_LENGTH=32
SERVICE_ROTATION_MIN_AGE=5m
SERVICE_SIGNATURE_ALGORITHM=RS256
SERVICE_SIGNATURE_KEY_SIZE=2048

# =============================================================================
# AUTHENTICATION SERVICE
# =============================================================================

# Enable/disable authentication service
AUTH_SERVICE_ENABLED=false

# Authentication service URL
AUTH_SERVICE_URL=http://auth-service:8081

# Authentication service timeout
AUTH_SERVICE_TIMEOUT=30

# Authentication retry configuration
AUTH_SERVICE_MAX_RETRIES=3
AUTH_SERVICE_RETRY_DELAY=1s

# =============================================================================
# PERMISSIONS SERVICE
# =============================================================================

# Enable/disable permissions service
PERM_SERVICE_ENABLED=false

# Permissions service URL
PERM_SERVICE_URL=http://perm-service:8082

# Permissions service timeout
PERM_SERVICE_TIMEOUT=30

# Permissions retry configuration
PERM_SERVICE_MAX_RETRIES=3
PERM_SERVICE_RETRY_DELAY=1s

# =============================================================================
# CHAT SERVICE
# =============================================================================

# Chat service database password
CHAT_DB_PASSWORD=chat_secure_password_change_me

# JWT secret for Chat service (must match Core's JWT secret)
JWT_SECRET=your-jwt-secret-key-change-in-production

# Chat service URL (for Core to communicate with Chat)
CHAT_SERVICE_URL=http://chat-service:9090

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Enable caching
CACHE_ENABLED=true

# Cache type: memory, redis
CACHE_TYPE=memory

# Redis configuration (if CACHE_TYPE=redis)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_RETRIES=3
REDIS_POOL_SIZE=10

# Cache TTL settings
CACHE_DEFAULT_TTL=5m
CACHE_PERMISSION_TTL=10m
CACHE_SERVICE_DISCOVERY_TTL=1m

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# CORS settings
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=*
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
CORS_EXPOSE_HEADERS=Content-Length
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=12h

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=100
RATE_LIMIT_BURST=200

# CSRF protection
CSRF_ENABLED=true
CSRF_TOKEN_LENGTH=32
CSRF_COOKIE_NAME=csrf_token
CSRF_HEADER_NAME=X-CSRF-Token

# Security headers
SECURITY_HEADERS_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# Brute force protection
BRUTE_FORCE_ENABLED=true
BRUTE_FORCE_MAX_ATTEMPTS=5
BRUTE_FORCE_WINDOW=5m
BRUTE_FORCE_BLOCK_DURATION=15m

# =============================================================================
# METRICS AND MONITORING
# =============================================================================

# Enable Prometheus metrics
METRICS_ENABLED=true
METRICS_PATH=/metrics
METRICS_PORT=9090

# Enable health check endpoint
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# Enable readiness probe
READINESS_CHECK_ENABLED=true
READINESS_CHECK_PATH=/ready

# =============================================================================
# AUDIT LOGGING
# =============================================================================

# Enable audit logging
AUDIT_ENABLED=true
AUDIT_LOG_PATH=/app/logs/audit
AUDIT_LOG_FORMAT=json
AUDIT_LOG_MAX_SIZE=100
AUDIT_LOG_MAX_BACKUPS=10
AUDIT_LOG_MAX_AGE=90

# =============================================================================
# DEVELOPMENT / TESTING
# =============================================================================

# Environment: development, staging, production
ENVIRONMENT=production

# Enable debug mode
DEBUG=false

# Enable profiling
PROFILING_ENABLED=false
PROFILING_PORT=6060

# Enable test mode
TEST_MODE=false

# Seed test data
SEED_TEST_DATA=false

# =============================================================================
# BUILD INFORMATION (Set during build)
# =============================================================================

BUILD_VERSION=1.0.0
BUILD_DATE=
BUILD_COMMIT=
